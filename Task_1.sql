-- HW_2
CREATE DATABASE SQLEducation;

CREATE TABLE EMPLOYEE
(
  EmpCode int IDENTITY(1,1) PRIMARY KEY,
  EmpFName varchar(15) NOT NULL,
  EmpLName varchar(15) NOT NULL,
  Job varchar(45) NOT NULL,
  Manager char(4) NOT NULL,
  HireDate date NOT NULL,
  Salary int NOT NULL,
  Commission int NOT NULL,
  DeptCode int NOT NULL
);

CREATE TABLE DEPARTMENT
(
  DeptCode int PRIMARY KEY,
  DeptName char(30) NOT NULL,
  Location varchar(33) NOT NULL
);

SELECT * 
FROM EMPLOYEE; 

SELECT * 
FROM DEPARTMENT;


-- HW_3
SELECT * 
FROM EMPLOYEE
WHERE Salary <= 3000;

SELECT DISTINCT Job 
FROM EMPLOYEE;

SELECT TOP 3 DeptName
FROM DEPARTMENT;

SELECT * 
FROM DEPARTMENT
WHERE DeptCode > 30; 


-- HW_4
-- Task_1
INSERT INTO DEPARTMENT (
  DeptCode,
  DeptName,
  [Location]
)
VALUES
  (10, 'FINANCE', 'EDINBURGH'),
  (20, 'SOFTWARE', 'PADDINGTON'),
  (30, 'SALES', 'MAIDSTONE'),
  (40, 'MARKETING', 'DARLINGTON'),
  (50, 'ADMIN', 'BIRMINGHAM');

SELECT * 
FROM DEPARTMENT;

INSERT INTO EMPLOYEE (
  EmpCode,
  EmpFName,
  EmpLName,
  Job,
  Manager,
  HireDate,
  Salary,
  Commission,
  DeptCode
)
VALUES 
  (9369, 'TONY', 'STARK', 'SOFTWARE ENGINEER', 7902, '1980-12-17', 2800, 0, 20),
  (9499, 'TIM', 'ADOLF', 'SALESMAN', 7698, '1981-02-20', 1600, 300, 30),    
  (9566, 'KIM', 'JARVIS', 'MANAGER', 7839, '1981-04-02', 3570, 0, 20),
  (9654, 'SAM', 'MILES', 'SALESMAN', 7698, '1981-09-28', 1250, 1400, 30),
  (9782, 'KEVIN', 'HILL', 'MANAGER', 7839, '1981-06-09', 2940, 0, 10),
  (9788, 'CONNIE', 'SMITH', 'ANALYST', 7566, '1982-12-09', 3000, 0, 20),
  (9839, 'ALFRED', 'KINSLEY', 'PRESIDENT', 7566, '1981-11-17', 5000, 0, 10),
  (9844, 'PAUL', 'TIMOTHY', 'SALESMAN', 7698, '1981-09-08', 1500, 0, 30),
  (9876, 'JOHN', 'ASGHAR', 'SOFTWARE ENGINEER', 7788, '1983-01-12', 3100, 0, 20),
  (9900, 'ROSE', 'SUMMERS', 'TECHNICAL LEAD', 7698, '1981-12-03', 2950, 0, 20),
  (9902, 'ANDREW', 'FAULKNER', 'ANAYLYST', 7566, '1981-12-03', 3000, 0, 10),
  (9934, 'KAREN', 'MATTHEWS', 'SOFTWARE ENGINEER', 7782, '1982-01-23', 3300, 0, 20),
  (9591, 'WENDY', 'SHAWN', 'SALESMAN', 7698, '1981-02-22', 500, 0, 30),
  (9698, 'BELLA', 'SWAN', 'MANAGER', 7839, '1981-05-01', 3420, 0, 30),
  (9777, 'MADII', 'HIMBURY', 'ANALYST', 7839, '1981-05-01', 2000, 200, 50),
  (9860, 'ATHENA', 'WILSON', 'ANALYST', 7839, '1992-06-21', 7000, 100, 50),
  (9861, 'JENNIFER', 'HUETTE', 'ANALYST', 7839, '1996-07-01', 5000, 100, 50);

SELECT *
FROM EMPLOYEE
ORDER BY Manager;


-- Task_2
SELECT *
FROM EMPLOYEE
WHERE EmpLName LIKE '[s-w]%' OR
EmpFName IN ('kim', 'sam')
ORDER BY EmpLName ASC;

SELECT *
FROM EMPLOYEE
WHERE Job = 'salesman' AND 
Manager = 7698 AND
Salary NOT BETWEEN 1500 AND 2000
ORDER BY Salary DESC;


-- Task_3
SELECT MIN(Salary)
FROM EMPLOYEE;

SELECT EmpFName, EmpLName, Job, Salary 
FROM EMPLOYEE
WHERE Salary = (
  SELECT MIN(Salary)
  FROM EMPLOYEE
);

SELECT MAX(Salary)
FROM EMPLOYEE;

SELECT EmpFName, EmpLName, Job, Salary 
FROM EMPLOYEE
WHERE Salary = (
  SELECT MAX(Salary)
  FROM EMPLOYEE
);

SELECT SUM(Salary) AS Sum_Salary_30
FROM EMPLOYEE
WHERE DeptCode = 30;

SELECT AVG(Salary) AS Avg_Salary_SWEng
FROM EMPLOYEE
WHERE Job = 'Software Engineer';

SELECT COUNT(*) AS Total_Emp_Manager_7839
FROM EMPLOYEE
WHERE Manager = 7839;
